# Release App ä½¿ç”¨æŒ‡å—

å®Œæ•´çš„ Release App ä½¿ç”¨æ–‡æ¡£å’Œç¤ºä¾‹ã€‚

## ğŸ“š ç›®å½•

- [å¿«é€Ÿå¼€å§‹](#å¿«é€Ÿå¼€å§‹)
- [åŠŸèƒ½ç‰¹æ€§](#åŠŸèƒ½ç‰¹æ€§)
- [è¯¦ç»†ä½¿ç”¨è¯´æ˜](#è¯¦ç»†ä½¿ç”¨è¯´æ˜)
- [ç‰ˆæœ¬JSONæ ¼å¼](#ç‰ˆæœ¬jsonæ ¼å¼)
- [æœ€ä½³å®è·µ](#æœ€ä½³å®è·µ)
- [å¸¸è§é—®é¢˜](#å¸¸è§é—®é¢˜)
- [è¿›é˜¶ç”¨æ³•](#è¿›é˜¶ç”¨æ³•)

## ğŸš€ å¿«é€Ÿå¼€å§‹

### å®‰è£…å‰æ

- Python 3.7+
- Git (ç”¨äºè®°å½•commitä¿¡æ¯)
- CMake æˆ– Make (ç”¨äºç¼–è¯‘C++é¡¹ç›®)

### åŸºæœ¬ä½¿ç”¨

1. **åœ¨ä½ çš„C++é¡¹ç›®ç›®å½•ä¸‹è¿è¡Œ**ï¼š
```bash
cd /path/to/your/cpp/project
python3 -m tools.release_app
```

2. **æŒ‰ç…§æç¤ºæ“ä½œ**ï¼š
   - é€‰æ‹©å‘å¸ƒç±»å‹ï¼ˆäºŒè¿›åˆ¶/commit/å®Œæ•´ï¼‰
   - è¾“å…¥ç‰ˆæœ¬å·ï¼ˆå¦‚ 1.0.0ï¼‰
   - è¾“å…¥å‘å¸ƒè¯´æ˜ï¼ˆå¯é€‰ï¼‰
   - ç¡®è®¤æ˜¯å¦æ¸…ç†æ„å»º

3. **æŸ¥çœ‹ç»“æœ**ï¼š
   - äºŒè¿›åˆ¶æ–‡ä»¶åœ¨ `build/` ç›®å½•
   - ç‰ˆæœ¬JSONæ–‡ä»¶åœ¨ `versions/` ç›®å½•

### ç¤ºä¾‹é¡¹ç›®

æˆ‘ä»¬æä¾›äº†ä¸€ä¸ªç¤ºä¾‹C++é¡¹ç›®ç”¨äºæµ‹è¯•ï¼š

```bash
cd examples/cpp_demo
python3 -m tools.release_app
```

## âœ¨ åŠŸèƒ½ç‰¹æ€§

### æ”¯æŒçš„å‘å¸ƒç±»å‹

1. **ä»…äºŒè¿›åˆ¶** (Binary Only)
   - ç¼–è¯‘é¡¹ç›®
   - æ‰“åŒ…äºŒè¿›åˆ¶æ–‡ä»¶
   - è®°å½•äºŒè¿›åˆ¶å…ƒæ•°æ®ï¼ˆå“ˆå¸Œã€å¤§å°ç­‰ï¼‰

2. **ä»…æäº¤** (Commit Only)
   - è®°å½•å½“å‰Git commitä¿¡æ¯
   - ä¸æ‰§è¡Œç¼–è¯‘
   - å¿«é€Ÿç‰ˆæœ¬æ ‡è®°

3. **å®Œæ•´å‘å¸ƒ** (Both)
   - ç»“åˆä¸Šè¿°ä¸¤è€…
   - å®Œæ•´çš„ç‰ˆæœ¬å¿«ç…§
   - æ¨èç”¨äºæ­£å¼å‘å¸ƒ

### æ”¯æŒçš„æ„å»ºç³»ç»Ÿ

- âœ… CMake (è‡ªåŠ¨æ£€æµ‹ `CMakeLists.txt`)
- âœ… Make (è‡ªåŠ¨æ£€æµ‹ `Makefile`)
- âœ… é€šç”¨æ¨¡å¼ (æ— éœ€ç¼–è¯‘)

## ğŸ“– è¯¦ç»†ä½¿ç”¨è¯´æ˜

### äº¤äº’å¼ç•Œé¢

```
==================================================
  Release App - äº¤äº’å¼å‘å¸ƒç®¡ç†å·¥å…·
==================================================

ğŸ“Œ å½“å‰GitçŠ¶æ€:
   åˆ†æ”¯: main
   æäº¤: a1b2c3d
   ä½œè€…: å¼ ä¸‰
   çŠ¶æ€: å¹²å‡€

è¯·é€‰æ‹©å‘å¸ƒç±»å‹:
  [1] ä»…äºŒè¿›åˆ¶ (ç¼–è¯‘ + æ‰“åŒ…)
  [2] ä»…æäº¤è®°å½• (è®°å½•Gitå…ƒæ•°æ®)
  [3] å®Œæ•´å‘å¸ƒ (äºŒè¿›åˆ¶ + æäº¤è®°å½•)

è¯·è¾“å…¥é€‰é¡¹ [1-3]: 3

è¯·è¾“å…¥ç‰ˆæœ¬å· (ä¾‹å¦‚ 1.0.0): 1.0.0

è¯·è¾“å…¥å‘å¸ƒè¯´æ˜ (ç•™ç©ºåˆ™è·³è¿‡):
> ä¿®å¤äº†å†…å­˜æ³„æ¼é—®é¢˜

æ˜¯å¦æŒ‡å®šäºŒè¿›åˆ¶æ–‡ä»¶åï¼Ÿ (ç•™ç©ºåˆ™è‡ªåŠ¨æ£€æµ‹)
äºŒè¿›åˆ¶æ–‡ä»¶å: 

æ˜¯å¦æ¸…ç†åé‡æ–°æ„å»ºï¼Ÿ [y/N]: y

â³ å¼€å§‹å‘å¸ƒ...
```

### ç‰ˆæœ¬å·è§„èŒƒ

æ¨èä½¿ç”¨**è¯­ä¹‰åŒ–ç‰ˆæœ¬** (Semantic Versioning)ï¼š

- `1.0.0` - æ­£å¼ç‰ˆæœ¬
- `1.2.3` - è¡¥ä¸ç‰ˆæœ¬
- `2.0.0-beta` - é¢„å‘å¸ƒç‰ˆæœ¬
- `1.1.0-rc.1` - å€™é€‰ç‰ˆæœ¬

## ğŸ“„ ç‰ˆæœ¬JSONæ ¼å¼

### å®Œæ•´ç¤ºä¾‹

```json
{
  "version": "1.0.0",
  "created_at": "2026-02-09T12:34:56Z",
  "release_type": "both",
  "release_notes": "ç¬¬ä¸€ä¸ªæ­£å¼ç‰ˆæœ¬",
  
  "binary": {
    "path": "/path/to/project/build/myapp",
    "relative_path": "build/myapp",
    "name": "myapp",
    "size": 2048576,
    "hash": "sha256:abc123def456...",
    "modified": 1707480896.123
  },
  
  "git": {
    "commit_hash": "a1b2c3d4e5f6...",
    "commit_short": "a1b2c3d",
    "branch": "main",
    "tag": "v1.0.0",
    "author": "å¼ ä¸‰",
    "author_email": "zhangsan@example.com",
    "commit_message": "Release version 1.0.0",
    "commit_time": "2026-02-09T12:00:00Z",
    "is_dirty": false,
    "remotes": [
      {"name": "origin", "url": "git@github.com:user/repo.git"}
    ]
  },
  
  "publisher": {
    "hostname": "dev-machine.local",
    "username": "yusen",
    "os": "Darwin",
    "arch": "arm64"
  }
}
```

### å­—æ®µè¯´æ˜

| å­—æ®µ | è¯´æ˜ |
|------|------|
| `version` | è¯­ä¹‰åŒ–ç‰ˆæœ¬å· |
| `created_at` | ISO 8601æ ¼å¼çš„æ—¶é—´æˆ³ |
| `release_type` | å‘å¸ƒç±»å‹ï¼šbinary/commit/both |
| `release_notes` | å‘å¸ƒè¯´æ˜ï¼ˆå¯é€‰ï¼‰ |
| `binary.path` | äºŒè¿›åˆ¶æ–‡ä»¶ç»å¯¹è·¯å¾„ |
| `binary.hash` | SHA256å“ˆå¸Œå€¼ï¼ˆå®Œæ•´æ€§æ ¡éªŒï¼‰ |
| `git.commit_short` | Git commitçŸ­å“ˆå¸Œ |
| `git.branch` | Gitåˆ†æ”¯å |
| `git.is_dirty` | æ˜¯å¦æœ‰æœªæäº¤çš„æ›´æ”¹ |

## ğŸ’¡ æœ€ä½³å®è·µ

### å‘å¸ƒæµç¨‹å»ºè®®

1. **å¼€å‘é˜¶æ®µ**
   - ä½¿ç”¨ `commit only` å¿«é€Ÿè®°å½•å¼€å‘å¿«ç…§
   - ç‰ˆæœ¬å·å¦‚ï¼š`1.1.0-dev`, `2.0.0-wip`

2. **æµ‹è¯•é˜¶æ®µ**
   - ä½¿ç”¨ `binary only` æµ‹è¯•ç¼–è¯‘å’Œæ‰“åŒ…
   - ç‰ˆæœ¬å·å¦‚ï¼š`1.0.0-alpha`, `1.0.0-rc.1`

3. **æ­£å¼å‘å¸ƒ**
   - ä½¿ç”¨ `both` å®Œæ•´å‘å¸ƒ
   - ç¡®ä¿ä»£ç åº“å¹²å‡€ï¼ˆæ— æœªæäº¤æ›´æ”¹ï¼‰
   - ç‰ˆæœ¬å·å¦‚ï¼š`1.0.0`, `1.2.3`

### ç‰ˆæœ¬å·ç®¡ç†

```
é¡¹ç›®å-X.Y.Z
  â””â”€ X: ä¸»ç‰ˆæœ¬å· (ä¸å…¼å®¹çš„APIä¿®æ”¹)
  â””â”€ Y: æ¬¡ç‰ˆæœ¬å· (å‘ä¸‹å…¼å®¹çš„åŠŸèƒ½æ€§æ–°å¢)
  â””â”€ Z: ä¿®è®¢å· (å‘ä¸‹å…¼å®¹çš„é—®é¢˜ä¿®æ­£)
```

### å‘å¸ƒå‰æ£€æŸ¥æ¸…å•

- [ ] ä»£ç å·²æäº¤åˆ°Git
- [ ] æ‰€æœ‰æµ‹è¯•é€šè¿‡
- [ ] æ›´æ–°äº†CHANGELOG
- [ ] ç‰ˆæœ¬å·ç¬¦åˆè¯­ä¹‰åŒ–è§„èŒƒ
- [ ] å‘å¸ƒè¯´æ˜æ¸…æ™°æ˜ç¡®

## â“ å¸¸è§é—®é¢˜

### Q1: ç¼–è¯‘å¤±è´¥æ€ä¹ˆåŠï¼Ÿ

**A**: æ£€æŸ¥ä»¥ä¸‹å‡ ç‚¹ï¼š
- ç¡®ä¿å·²å®‰è£…CMakeæˆ–Make
- æ£€æŸ¥ `CMakeLists.txt` æˆ– `Makefile` æ˜¯å¦æ­£ç¡®
- æŸ¥çœ‹ç¼–è¯‘é”™è¯¯æ—¥å¿—
- å¯ä»¥æ‰‹åŠ¨ç¼–è¯‘æµ‹è¯•ï¼š`mkdir build && cd build && cmake .. && make`

### Q2: å¦‚ä½•å‘å¸ƒå¤šä¸ªäºŒè¿›åˆ¶æ–‡ä»¶ï¼Ÿ

**A**: 
- å¯ä»¥å¤šæ¬¡è¿è¡Œ Release App
- æ¯æ¬¡æŒ‡å®šä¸åŒçš„äºŒè¿›åˆ¶æ–‡ä»¶å
- æˆ–åœ¨ç‰ˆæœ¬JSONä¸­æ‰‹åŠ¨æ·»åŠ å¤šä¸ªäºŒè¿›åˆ¶è®°å½•

### Q3: ç‰ˆæœ¬æ–‡ä»¶å¯ä»¥ä¿®æ”¹å—ï¼Ÿ

**A**: 
- å¯ä»¥æ‰‹åŠ¨ç¼–è¾‘ `versions/*.json` æ–‡ä»¶
- ä½†è¦æ³¨æ„ä¿æŒJSONæ ¼å¼æ­£ç¡®
- å“ˆå¸Œå€¼ç­‰å­—æ®µåº”è¯¥ç”±å·¥å…·ç”Ÿæˆ

### Q4: å¦‚ä½•å›é€€åˆ°æ—§ç‰ˆæœ¬ï¼Ÿ

**A**: 
- Release App ä¸æä¾›è‡ªåŠ¨å›æ»šåŠŸèƒ½
- å¯ä»¥é€šè¿‡ Git å›é€€ä»£ç 
- æŸ¥çœ‹ `versions/` ç›®å½•ä¸‹çš„å†å²ç‰ˆæœ¬æ–‡ä»¶
- é‡æ–°ç¼–è¯‘æŒ‡å®šçš„ç‰ˆæœ¬

### Q5: æ”¯æŒWindowså—ï¼Ÿ

**A**: 
- ç†è®ºä¸Šæ”¯æŒï¼Œä½†ä¸»è¦åœ¨Unix-likeç³»ç»Ÿä¸Šæµ‹è¯•
- Windowsä¸Šå¯èƒ½éœ€è¦ä¿®æ”¹è·¯å¾„å¤„ç†é€»è¾‘
- éœ€è¦å®‰è£…Git for Windows

## ğŸ”§ è¿›é˜¶ç”¨æ³•

### é›†æˆåˆ°CI/CD

åœ¨ GitHub Actions ä¸­ä½¿ç”¨ï¼š

```yaml
name: Release

on:
  push:
    tags:
      - 'v*'

jobs:
  release:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
      
      - name: Install CMake
        run: sudo apt-get install cmake
      
      - name: Build and Release
        run: |
          VERSION=${GITHUB_REF#refs/tags/v}
          python3 -m tools.release_app \
            --version $VERSION \
            --type both \
            --non-interactive
```

### æ‰¹é‡å‘å¸ƒ

```bash
#!/bin/bash
# release_all.sh

for project in project1 project2 project3; do
    cd $project
    python3 -m tools.release_app --version 1.0.0 --type both
    cd ..
done
```

### æŸ¥çœ‹ç‰ˆæœ¬å†å²

```python
from pathlib import Path
import json

versions_dir = Path('versions')
versions = sorted(versions_dir.glob('*.json'))

for version_file in versions:
    with open(version_file) as f:
        data = json.load(f)
        print(f"{data['version']}: {data['release_notes']}")
```

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [README.md](tools/release_app/README.md) - Release App é¡¹ç›®æ–‡æ¡£
- [examples/cpp_demo/](examples/cpp_demo/) - ç¤ºä¾‹C++é¡¹ç›®
- [Semantic Versioning](https://semver.org/) - è¯­ä¹‰åŒ–ç‰ˆæœ¬è§„èŒƒ

## ğŸ¤ è´¡çŒ®

æ¬¢è¿æäº¤é—®é¢˜å’Œæ”¹è¿›å»ºè®®ï¼

---

**Happy Releasing! ğŸ‰**
