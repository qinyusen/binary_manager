# Release App

äº¤äº’å¼å‘å¸ƒç®¡ç†å·¥å…·ï¼Œç”¨äºç®¡ç†C++é¡¹ç›®çš„ç¼–è¯‘ã€æ‰“åŒ…å’Œç‰ˆæœ¬è¿½è¸ªã€‚

## åŠŸèƒ½ç‰¹æ€§

- âœ… **äº¤äº’å¼CLI**ï¼šç®€å•çš„é—®ç­”å¼æ“ä½œæµç¨‹
- ğŸ”¨ **C++ç¼–è¯‘æ”¯æŒ**ï¼šæ”¯æŒCMakeå’ŒMakeæ„å»ºç³»ç»Ÿ
- ğŸ“¦ **äºŒè¿›åˆ¶æ‰“åŒ…**ï¼šè‡ªåŠ¨ç¼–è¯‘å¹¶è®°å½•äºŒè¿›åˆ¶ä¿¡æ¯
- ğŸŒ³ **Gité›†æˆ**ï¼šè®°å½•commitå…ƒæ•°æ®ï¼Œå…³è”ä»£ç ç‰ˆæœ¬
- ğŸ“ **ç‰ˆæœ¬è¿½è¸ª**ï¼šç”ŸæˆJSONæ ¼å¼çš„ç‰ˆæœ¬æ–‡ä»¶
- ğŸ” **è‡ªåŠ¨æ£€æµ‹**ï¼šè‡ªåŠ¨æ£€æµ‹æ„å»ºç³»ç»Ÿå’ŒäºŒè¿›åˆ¶æ–‡ä»¶

## ç›®å½•ç»“æ„

```
tools/release_app/
â”œâ”€â”€ __init__.py              # åŒ…åˆå§‹åŒ–
â”œâ”€â”€ __main__.py             # ä¸»å…¥å£
â”œâ”€â”€ cli.py                  # äº¤äº’å¼CLI
â”œâ”€â”€ release_manager.py      # å‘å¸ƒç®¡ç†å™¨
â”œâ”€â”€ version_tracker.py      # ç‰ˆæœ¬è¿½è¸ª
â”œâ”€â”€ utils.py                # å·¥å…·å‡½æ•°
â””â”€â”€ compilers/              # ç¼–è¯‘å™¨æ¨¡å—
    â”œâ”€â”€ __init__.py
    â”œâ”€â”€ compiler.py         # ç¼–è¯‘å™¨åŸºç±»
    â”œâ”€â”€ c_compiler.py       # C++ç¼–è¯‘å™¨
    â””â”€â”€ generic_compiler.py # é€šç”¨ç¼–è¯‘å™¨
```

## ä½¿ç”¨æ–¹æ³•

### åŸºæœ¬ä½¿ç”¨

```bash
# åœ¨é¡¹ç›®æ ¹ç›®å½•è¿è¡Œ
python3 -m tools.release_app

# æˆ–æŒ‡å®šé¡¹ç›®ç›®å½•
python3 -m tools.release_app --project-dir /path/to/project
```

### äº¤äº’æµç¨‹

```
==================================================
  Release App - äº¤äº’å¼å‘å¸ƒç®¡ç†å·¥å…·
==================================================

ğŸ“Œ å½“å‰GitçŠ¶æ€:
   åˆ†æ”¯: main
   æäº¤: a1b2c3d
   ä½œè€…: å¼ ä¸‰
   çŠ¶æ€: å¹²å‡€

è¯·é€‰æ‹©å‘å¸ƒç±»å‹:
  [1] ä»…äºŒè¿›åˆ¶ (ç¼–è¯‘ + æ‰“åŒ…)
  [2] ä»…æäº¤è®°å½• (è®°å½•Gitå…ƒæ•°æ®)
  [3] å®Œæ•´å‘å¸ƒ (äºŒè¿›åˆ¶ + æäº¤è®°å½•)

è¯·è¾“å…¥é€‰é¡¹ [1-3]: 3

è¯·è¾“å…¥ç‰ˆæœ¬å· (ä¾‹å¦‚ 1.0.0): 1.0.0

è¯·è¾“å…¥å‘å¸ƒè¯´æ˜ (ç•™ç©ºåˆ™è·³è¿‡):
> ç¬¬ä¸€ä¸ªæ­£å¼ç‰ˆæœ¬

æ˜¯å¦æŒ‡å®šäºŒè¿›åˆ¶æ–‡ä»¶åï¼Ÿ (ç•™ç©ºåˆ™è‡ªåŠ¨æ£€æµ‹)
äºŒè¿›åˆ¶æ–‡ä»¶å: 

æ˜¯å¦æ¸…ç†åé‡æ–°æ„å»ºï¼Ÿ [y/N]: y

â³ å¼€å§‹å‘å¸ƒ...

==================================================
âœ… å®Œæ•´å‘å¸ƒæˆåŠŸï¼ˆäºŒè¿›åˆ¶+commitï¼‰
   ç‰ˆæœ¬: 1.0.0
   äºŒè¿›åˆ¶: myapp
   å¤§å°: 1.23 MB
   å“ˆå¸Œ: sha256:abc123...
   Commit: a1b2c3d
   ç‰ˆæœ¬æ–‡ä»¶: /path/to/project/versions/1.0.0.json
==================================================
```

## ç‰ˆæœ¬JSONæ ¼å¼

æ¯æ¬¡å‘å¸ƒä¼šåœ¨ `versions/` ç›®å½•ä¸‹ç”Ÿæˆä¸€ä¸ªç‰ˆæœ¬æ–‡ä»¶ï¼š

```json
{
  "version": "1.0.0",
  "created_at": "2026-02-09T12:34:56Z",
  "release_type": "both",
  "release_notes": "ç¬¬ä¸€ä¸ªæ­£å¼ç‰ˆæœ¬",
  
  "binary": {
    "path": "/path/to/build/myapp",
    "relative_path": "build/myapp",
    "name": "myapp",
    "size": 2048576,
    "hash": "sha256:abc123...",
    "modified": 1707480896.123
  },
  
  "git": {
    "commit_hash": "a1b2c3d4e5f6...",
    "commit_short": "a1b2c3d",
    "branch": "main",
    "tag": null,
    "author": "å¼ ä¸‰",
    "author_email": "zhangsan@example.com",
    "commit_message": "Initial release",
    "commit_time": "2026-02-09T12:00:00Z",
    "is_dirty": false,
    "remotes": [
      {"name": "origin", "url": "git@github.com:user/repo.git"}
    ]
  },
  
  "publisher": {
    "hostname": "dev-machine.local",
    "username": "yusen",
    "os": "Darwin",
    "arch": "arm64"
  }
}
```

## æ”¯æŒçš„æ„å»ºç³»ç»Ÿ

- **CMake**: è‡ªåŠ¨æ£€æµ‹ `CMakeLists.txt`
- **Make**: è‡ªåŠ¨æ£€æµ‹ `Makefile`
- **Generic**: ä¸éœ€è¦ç¼–è¯‘çš„é¡¹ç›®

## å¸¸è§é—®é¢˜

### Q: å¦‚ä½•æŒ‡å®šè‡ªå®šä¹‰æ„å»ºç›®å½•ï¼Ÿ
A: ç›®å‰é»˜è®¤ä½¿ç”¨ `build/` ç›®å½•ï¼Œå¯ä»¥åœ¨ä»£ç ä¸­ä¿®æ”¹ `build_dir` å‚æ•°ã€‚

### Q: å¦‚ä½•å¤„ç†å¤šä¸ªäºŒè¿›åˆ¶æ–‡ä»¶ï¼Ÿ
A: å¯ä»¥é€šè¿‡äº¤äº’å¼ç•Œé¢æŒ‡å®šäºŒè¿›åˆ¶æ–‡ä»¶åã€‚

### Q: ç‰ˆæœ¬å·æœ‰ä»€ä¹ˆè¦æ±‚ï¼Ÿ
A: å»ºè®®ä½¿ç”¨è¯­ä¹‰åŒ–ç‰ˆæœ¬ï¼ˆSemantic Versioningï¼‰ï¼Œå¦‚ `1.0.0`ã€`2.1.3-beta`ã€‚

### Q: æ˜¯å¦æ”¯æŒå›æ»šï¼Ÿ
A: ç›®å‰ä¸æ”¯æŒå›æ»šï¼Œä½†å¯ä»¥é€šè¿‡æŸ¥çœ‹ `versions/` ç›®å½•ä¸‹çš„å†å²ç‰ˆæœ¬æ–‡ä»¶æ¥ç®¡ç†ç‰ˆæœ¬ã€‚

## å¼€å‘è¯´æ˜

### æ‰©å±•æ–°çš„ç¼–è¯‘å™¨

```python
from .compilers.compiler import BaseCompiler

class MyCompiler(BaseCompiler):
    def compile(self, target, verbose):
        # å®ç°ç¼–è¯‘é€»è¾‘
        pass
    
    def clean(self):
        # å®ç°æ¸…ç†é€»è¾‘
        pass
    
    def find_binary(self, binary_name):
        # å®ç°äºŒè¿›åˆ¶æŸ¥æ‰¾é€»è¾‘
        pass
```

### æ·»åŠ æ–°çš„å‘å¸ƒç±»å‹

åœ¨ `ReleaseManager` ç±»ä¸­æ·»åŠ æ–°çš„æ–¹æ³•ï¼š

```python
def release_custom(self, version, **kwargs):
    # è‡ªå®šä¹‰å‘å¸ƒé€»è¾‘
    pass
```

## ä¾èµ–

- Python 3.7+
- Git (ç”¨äºæå–commitä¿¡æ¯)
- CMake æˆ– Make (ç”¨äºç¼–è¯‘C++é¡¹ç›®)

## è®¸å¯è¯

MIT License
